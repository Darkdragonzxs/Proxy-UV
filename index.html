<!DOCTYPE html>
<html lang="en" data-theme="relax">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ZXS Proxy with DevTools</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- Navbar & Controls -->
  <header id="navbar">
    <div class="nav-left">
      <input type="text" id="url-input" placeholder="Search or enter URL..." autocomplete="off" />
      <button id="go-button" aria-label="Go to URL">Go</button>
      <button id="bookmark-button" title="Bookmark this page">☆</button>
    </div>
    <div class="nav-right">
      <select id="theme-switcher" aria-label="Theme selector">
        <option value="relax">Relax</option>
        <option value="dark">Dark</option>
        <option value="light">Light</option>
        <option value="ocean">Ocean</option>
      </select>
      <button id="open-devtools" title="Toggle Developer Tools">🛠 DevTools</button>
    </div>
  </header>

  <!-- Bookmarks -->
  <section id="bookmarks-bar" aria-label="Bookmarks"></section>

  <!-- Tab Bar -->
  <nav id="tab-bar" aria-label="Tabs"></nav>

  <!-- Tab Content Area -->
  <main id="tab-content" role="main">
    <!-- Each tab's iframe goes here -->
  </main>

  <!-- Developer Tools Panel -->
  <aside id="devtools-panel" aria-label="Developer Tools" hidden>
    <header id="devtools-header">
      <h2>🧪 Developer Tools</h2>
      <button id="close-devtools" title="Close DevTools">✖</button>
    </header>

    <!-- DevTools Tab Buttons -->
    <div id="devtools-tabs">
      <button data-tab="console" class="devtools-tab active">Console</button>
      <button data-tab="cookies" class="devtools-tab">Cookies</button>
      <button data-tab="dom" class="devtools-tab">DOM</button>
      <button data-tab="storage" class="devtools-tab">Storage</button>
    </div>

    <!-- DevTools Content Area -->
    <div id="devtools-content">
      
      <!-- Console -->
      <section id="console-panel" class="devtools-section active" aria-labelledby="Console Tab">
        <textarea id="console-input" placeholder="Enter JavaScript and hit Run..."></textarea>
        <button id="run-js">Run</button>
        <pre id="console-output" class="dev-output">[Console ready]</pre>
      </section>

      <!-- Cookies -->
      <section id="cookies-panel" class="devtools-section" aria-labelledby="Cookies Tab">
        <h3>Cookies</h3>
        <pre id="cookie-data" class="dev-output">[Cookies will show here]</pre>
      </section>

      <!-- DOM Inspector -->
      <section id="dom-panel" class="devtools-section" aria-labelledby="DOM Tab">
        <h3>DOM Tree</h3>
        <pre id="dom-tree" class="dev-output">[DOM structure will appear here]</pre>
      </section>

      <!-- Storage Inspector -->
      <section id="storage-panel" class="devtools-section" aria-labelledby="Storage Tab">
        <h3>localStorage / sessionStorage</h3>
        <pre id="storage-data" class="dev-output">[Storage data will appear here]</pre>
      </section>

    </div>
  </aside>

  <!-- Floating DevTools Toggle Button (for mobile) -->
  <button id="floating-devtools-toggle" title="Toggle DevTools">🛠</button>
<style>
/* ==========================
   Global Theme Definitions
   ========================== */

:root {
  --bg: #fdf7f1;
  --fg: #3d3a4e;
  --accent: #d9a7eb;
  --accent-dark: #b97dd4;
  --tab-bg: #f2eafa;
  --console-bg: #f9f4ff;
  --shadow: rgba(0, 0, 0, 0.1);
  --radius: 10px;
  --transition: 0.3s ease;
  --font: 'Segoe UI', sans-serif;
  --header-height: 58px;
  --dev-bg: #fff;
  --input-bg: #fff;
}

[data-theme="dark"] {
  --bg: #121212;
  --fg: #eeeeee;
  --accent: #7289da;
  --accent-dark: #5b6eae;
  --tab-bg: #1e1e1e;
  --console-bg: #181818;
  --shadow: rgba(255, 255, 255, 0.05);
  --input-bg: #2c2c2c;
  --dev-bg: #1a1a1a;
}

[data-theme="light"] {
  --bg: #ffffff;
  --fg: #222;
  --accent: #7aa2f7;
  --accent-dark: #547cc0;
  --tab-bg: #f6f6f6;
  --console-bg: #eeeeee;
  --input-bg: #ffffff;
  --dev-bg: #f4f4f4;
}

[data-theme="ocean"] {
  --bg: #e0f7fa;
  --fg: #004d40;
  --accent: #00acc1;
  --accent-dark: #007c91;
  --tab-bg: #b2ebf2;
  --console-bg: #d0f0f5;
  --input-bg: #ffffff;
  --dev-bg: #e0f4f7;
}


/* ==========================
   Base Reset & Utilities
   ========================== */

* {
  box-sizing: border-box;
  transition: background var(--transition), color var(--transition), border var(--transition), transform var(--transition);
}

html, body {
  margin: 0;
  padding: 0;
  font-family: var(--font);
  background: var(--bg);
  color: var(--fg);
  height: 100%;
  overflow: hidden;
}

button, input, select, textarea {
  font-family: inherit;
  font-size: 1rem;
  border: none;
  outline: none;
}

button {
  cursor: pointer;
  border-radius: var(--radius);
  padding: 8px 12px;
  background: var(--accent);
  color: white;
  font-weight: bold;
}

button:hover {
  background: var(--accent-dark);
}


/* ==========================
   Header (Navigation Bar)
   ========================== */

#navbar {
  height: var(--header-height);
  background: var(--tab-bg);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 12px;
  border-bottom: 1px solid var(--shadow);
  position: relative;
  z-index: 10;
}

.nav-left, .nav-right {
  display: flex;
  align-items: center;
  gap: 10px;
}

#url-input {
  padding: 8px 14px;
  border-radius: var(--radius);
  border: 2px solid var(--accent);
  background: var(--input-bg);
  width: 400px;
  max-width: 60vw;
}

#bookmark-button {
  font-size: 1.2rem;
  padding: 6px 12px;
  background: transparent;
  color: var(--accent);
}

#bookmark-button:hover {
  background: var(--accent);
  color: white;
}


/* ==========================
   Bookmarks Bar
   ========================== */

#bookmarks-bar {
  display: flex;
  flex-wrap: nowrap;
  overflow-x: auto;
  background: var(--tab-bg);
  padding: 6px 10px;
  gap: 8px;
  border-bottom: 1px solid var(--shadow);
}

#bookmarks-bar .bookmark {
  background: var(--accent);
  color: white;
  padding: 6px 10px;
  border-radius: 6px;
  cursor: pointer;
  white-space: nowrap;
}

#bookmarks-bar .bookmark:hover {
  background: var(--accent-dark);
}


/* ==========================
   Tabs Area
   ========================== */

#tab-bar {
  display: flex;
  background: var(--tab-bg);
  border-bottom: 1px solid var(--shadow);
  overflow-x: auto;
  padding: 4px 10px;
  gap: 8px;
}

#tab-bar .tab {
  padding: 10px 16px;
  border-radius: 8px 8px 0 0;
  background: transparent;
  color: var(--fg);
  cursor: pointer;
  font-weight: 500;
  border-bottom: 3px solid transparent;
}

#tab-bar .tab.active {
  border-bottom: 3px solid var(--accent);
  font-weight: bold;
  color: var(--accent);
}


/* ==========================
   Main Content (Iframes)
   ========================== */

#tab-content {
  flex: 1;
  position: relative;
  background: var(--bg);
}

#tab-content iframe {
  width: 100%;
  height: calc(100vh - var(--header-height) - 120px);
  border: none;
  position: absolute;
  top: 0;
  left: 0;
}


/* ==========================
   DevTools Panel
   ========================== */

#devtools-panel {
  /* Hide by default */
  display: none;

  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  max-height: 60%;
  background: var(--dev-bg);
  color: var(--fg);
  border-top: 2px solid var(--accent);
  box-shadow: 0 -2px 8px var(--shadow);
  flex-direction: column;
  z-index: 99;

  /* Make sure it can flex when shown */
  /* Note: do NOT set display:flex here since default is hidden */
}

#devtools-panel.open {
  /* Show panel */
  display: flex;
}

/* You can keep the rest of your existing devtools styles as is */
#devtools-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 14px;
  background: var(--tab-bg);
  border-bottom: 1px solid var(--shadow);
}

#devtools-tabs {
  display: flex;
  background: var(--tab-bg);
  border-bottom: 1px solid var(--shadow);
}

.devtools-tab {
  flex: 1;
  padding: 10px;
  background: none;
  border: none;
  cursor: pointer;
  font-weight: bold;
  color: var(--fg);
  transition: background 0.2s;
}

.devtools-tab:hover {
  background: var(--accent);
  color: white;
}

.devtools-tab.active {
  background: var(--accent-dark);
  color: white;
}

#devtools-content {
  flex: 1;
  overflow-y: auto;
  padding: 12px;
  background: var(--console-bg);
}

.devtools-section {
  display: none;
}

.devtools-section.active {
  display: block;
}

.dev-output {
  background: #00000015;
  padding: 10px;
  border-radius: 6px;
  font-family: monospace;
  white-space: pre-wrap;
  max-height: 250px;
  overflow-y: auto;
}


/* ==========================
   Dev Console Specific
   ========================== */

#console-input {
  width: 100%;
  height: 70px;
  resize: vertical;
  font-family: monospace;
  padding: 10px;
  border-radius: 6px;
  margin-bottom: 8px;
  background: var(--input-bg);
  color: var(--fg);
}


/* ==========================
   Floating DevTools Toggle
   ========================== */

#floating-devtools-toggle {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: var(--accent);
  color: white;
  border-radius: 50%;
  width: 48px;
  height: 48px;
  font-size: 1.2rem;
  z-index: 100;
  display: none;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 12px var(--shadow);
}

@media screen and (max-width: 768px) {
  #floating-devtools-toggle {
    display: flex;
  }
}


/* ==========================
   Animations (Optional)
   ========================== */

.fade-in {
  animation: fadeIn 0.3s ease-in-out forwards;
}

@keyframes fadeIn {
  from { opacity: 0; transform: scale(0.97); }
  to { opacity: 1; transform: scale(1); }
}

  </style>
<script>
// =====================
// Global State
// =====================
const tabs = [];
let currentTab = null;
let tabIdCounter = 0;

// =====================
// Tab + Iframe Logic
// =====================
function openTabFromInput() {
  const input = document.getElementById("url-input").value.trim();
  if (!input) return;
  openTab(input);
}

function openTab(rawUrl) {
  const url = rawUrl.startsWith("http") ? rawUrl : `https://${rawUrl}`;
  const encoded = encodeURIComponent(url);
  const finalUrl = `/s/embed.html#${decodeURIComponent(encoded)}`;
  const iframe = document.createElement("iframe");
  iframe.src = finalUrl;
  iframe.dataset.tabId = tabIdCounter;

  const tab = {
    id: tabIdCounter,
    title: new URL(url).hostname,
    url: finalUrl,
    iframe
  };
  tabs.push(tab);
  currentTab = tab.id;
  tabIdCounter++;

  updateTabs();
  updateIframeView();
  logDev(`Opened: ${url}`);
}

function updateTabs() {
  const tabBar = document.getElementById("tab-bar");
  tabBar.innerHTML = "";

  tabs.forEach(tab => {
    const el = document.createElement("div");
    el.className = `tab ${tab.id === currentTab ? "active" : ""}`;
    el.textContent = tab.title;
    el.onclick = () => switchTab(tab.id);
    tabBar.appendChild(el);
  });
}

function switchTab(id) {
  currentTab = id;
  updateTabs();
  updateIframeView();
  logDev(`Switched to tab: ${id}`);
}

function updateIframeView() {
  const container = document.getElementById("tab-content");
  container.innerHTML = "";

  const tab = tabs.find(t => t.id === currentTab);
  if (!tab) return;

  container.appendChild(tab.iframe);
}

// =====================
// Bookmarks
// =====================
function addBookmark() {
  const tab = tabs.find(t => t.id === currentTab);
  if (!tab) return;

  const bookmarksBar = document.getElementById("bookmarks-bar");
  const div = document.createElement("div");
  div.className = "bookmark";
  div.textContent = new URL(tab.url.split("#")[1]).hostname;
  div.onclick = () => openTab(tab.url.split("#")[1]);
  bookmarksBar.appendChild(div);
  logDev(`Bookmarked: ${tab.url}`);
}

// =====================
// Themes
// =====================
function switchTheme(value) {
  document.documentElement.setAttribute("data-theme", value);
  logDev(`Theme changed to: ${value}`);
}

// =====================
// Developer Tools
// =====================
function toggleDevTools() {
  const panel = document.getElementById("devtools-panel");
  if (panel.hasAttribute("hidden")) {
    panel.removeAttribute("hidden");
  } else {
    panel.setAttribute("hidden", "true");
  }
}

function switchDevTab(tabName) {
  document.querySelectorAll(".devtools-section").forEach(el => el.classList.remove("active"));
  document.querySelectorAll(".devtools-tab").forEach(btn => btn.classList.remove("active"));

  document.getElementById(`${tabName}-panel`).classList.add("active");
  document.querySelector(`[data-tab='${tabName}']`).classList.add("active");

  if (tabName === "cookies") loadCookies();
  if (tabName === "dom") loadDOMTree();
  if (tabName === "storage") loadStorage();
}

function runConsoleJS() {
  const iframe = getActiveIframe();
  const code = document.getElementById("console-input").value;
  try {
    const result = iframe.contentWindow.eval(code);
    document.getElementById("console-output").textContent = `> ${code}\n${result}`;
  } catch (e) {
    document.getElementById("console-output").textContent = `> ${code}\n⚠️ ${e}`;
  }
}

function loadCookies() {
  const iframe = getActiveIframe();
  try {
    const cookies = iframe.contentWindow.document.cookie;
    document.getElementById("cookie-data").textContent = cookies || "[No cookies]";
  } catch {
    document.getElementById("cookie-data").textContent = "[Cross-origin: cannot access cookies]";
  }
}

function loadDOMTree() {
  const iframe = getActiveIframe();
  try {
    const html = formatDOMTree(iframe.contentWindow.document.body, 0);
    document.getElementById("dom-tree").textContent = html;
  } catch {
    document.getElementById("dom-tree").textContent = "[Cross-origin: cannot access DOM]";
  }
}

function loadStorage() {
  const iframe = getActiveIframe();
  try {
    const local = iframe.contentWindow.localStorage;
    const session = iframe.contentWindow.sessionStorage;
    let output = `localStorage:\n`;
    for (let k in local) {
      if (local.hasOwnProperty(k)) output += `  ${k}: ${local[k]}\n`;
    }
    output += `\nsessionStorage:\n`;
    for (let k in session) {
      if (session.hasOwnProperty(k)) output += `  ${k}: ${session[k]}\n`;
    }
    document.getElementById("storage-data").textContent = output;
  } catch {
    document.getElementById("storage-data").textContent = "[Cross-origin: cannot access storage]";
  }
}

function formatDOMTree(node, depth = 0) {
  if (!node || !node.nodeType) return "";
  const indent = "  ".repeat(depth);
  let result = `${indent}<${node.nodeName.toLowerCase()}>\n`;
  if (node.children) {
    for (let child of node.children) {
      result += formatDOMTree(child, depth + 1);
    }
  }
  return result;
}

function getActiveIframe() {
  const tab = tabs.find(t => t.id === currentTab);
  return tab?.iframe;
}

function logDev(msg) {
  const out = document.getElementById("console-output");
  if (out) out.textContent += `\n${msg}`;
}

// =====================
// Event Listeners
// =====================
document.getElementById("go-button").onclick = openTabFromInput;
document.getElementById("bookmark-button").onclick = addBookmark;
document.getElementById("theme-switcher").onchange = e => switchTheme(e.target.value);
document.getElementById("run-js").onclick = runConsoleJS;
document.getElementById("open-devtools").onclick = toggleDevTools;
document.getElementById("close-devtools").onclick = toggleDevTools;
document.getElementById("floating-devtools-toggle").onclick = toggleDevTools;
document.querySelectorAll(".devtools-tab").forEach(btn => {
  btn.addEventListener("click", () => switchDevTab(btn.dataset.tab));
});
  </script>
</body>
</html>
